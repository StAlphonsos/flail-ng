Return-Path: <owner-ports+M73451@openbsd.org>
Delivered-To: attila@stalphonsos.com
Received: (qmail 1538 invoked from network); 1 Jun 2015 13:24:51 -0000
Received: from unknown (HELO shear.ucar.edu) (192.43.244.163)
  by x.stalphonsos.net with SMTP; 1 Jun 2015 13:24:51 -0000
Received: from openbsd.org (localhost [127.0.0.1])
	by shear.ucar.edu (8.14.7/8.14.7) with ESMTP id t51DNpq5028401;
	Mon, 1 Jun 2015 07:23:51 -0600 (MDT)
Received: from dim13.org (dim13.org [85.10.208.206])
	by shear.ucar.edu (8.14.7/8.14.7) with ESMTP id t51DMcwa029781
	(version=TLSv1/SSLv3 cipher=DHE-DSS-AES256-GCM-SHA384 bits=256 verify=FAIL)
	for <ports@openbsd.org>; Mon, 1 Jun 2015 07:22:41 -0600 (MDT)
Received: from [192.168.245.85] (ip5b42edb7.dynamic.kabel-deutschland.de [91.66.237.183]);
	by dim13.org (OpenSMTPD) with ESMTPSA id 04493d86;
	TLS version=TLSv1/SSLv3 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128 verify=NO;
	for <ports@openbsd.org>;
	Mon, 1 Jun 2015 15:22:36 +0200 (CEST)
Message-ID: <556C5C9B.9050404@dim13.org>
Date: Mon, 01 Jun 2015 15:22:35 +0200
From: Dimitri Sokolyuk <demon@dim13.org>
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:31.0) Gecko/20100101 Icedove/31.4.0
MIME-Version: 1.0
To: ports@openbsd.org
Subject: [patch] sysutils/collectd Bind9 plugin update
OpenPGP: url=http://pool.sks-keyservers.net/pks/lookup?op=get&search=0x31C8B85F5A7C3054
Content-Type: multipart/signed; micalg=pgp-sha1;
 protocol="application/pgp-signature";
 boundary="QXOF2RgWocS5EkG4rmn5h8Hv5CBMdko5g"
List-Help: <mailto:majordomo@openbsd.org?body=help>
List-ID: <ports.openbsd.org>
List-Owner: <mailto:owner-ports@openbsd.org>
List-Post: <mailto:ports@openbsd.org>
List-Subscribe: <mailto:majordomo@openbsd.org?body=sub%20ports>
List-Unsubscribe: <mailto:majordomo@openbsd.org?body=unsub%20ports>
X-Loop: ports@openbsd.org
Precedence: bulk
Sender: owner-ports@openbsd.org

This is an OpenPGP/MIME signed message (RFC 4880 and 3156)
--QXOF2RgWocS5EkG4rmn5h8Hv5CBMdko5g
Content-Type: multipart/mixed;
 boundary="------------030301050805060908040300"

This is a multi-part message in MIME format.
--------------030301050805060908040300
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable

Hi ports@

here is a patch for collectd-5.4.1 bind plugin to support the new XML v3 =
API

Could please someone check it in?

ref: https://github.com/collectd/collectd/pull/742

--=20
Dimitri Sokolyuk -- http://www.dim13.org/


--------------030301050805060908040300
Content-Type: text/plain; charset=UTF-8;
 name="patch-src_bind_c"
Content-Transfer-Encoding: base64
Content-Disposition: attachment;
 filename="patch-src_bind_c"

JE9wZW5CU0QkCmh0dHBzOi8vZ2l0aHViLmNvbS9jb2xsZWN0ZC9jb2xsZWN0ZC9wdWxsLzc0
MgotLS0gc3JjL2JpbmQuYy5vcmlnCVN1biBKYW4gMjYgMDk6MDk6MjMgMjAxNAorKysgc3Jj
L2JpbmQuYwlNb24gSnVuICAxIDE1OjAwOjU0IDIwMTUKQEAgLTYyNyw2ICs2MjcsODQgQEAg
c3RhdGljIGludCBiaW5kX3BhcnNlX2dlbmVyaWNfdmFsdWVfbGlzdCAoY29uc3QgY2hhciAq
CiAgIHJldHVybiAoMCk7CiB9IC8qIH19fSBpbnQgYmluZF9wYXJzZV9nZW5lcmljX3ZhbHVl
X2xpc3QgKi8KIAorLyoKKyAqIGJpbmRfcGFyc2VfZ2VuZXJpY19uYW1lX2F0dHJfdmFsdWVf
bGlzdAorICoKKyAqIFJlYWRzIHN0YXRpc3RpY3MgaW4gdGhlIGZvcm06CisgKiA8Zm9vPgor
ICogICA8Y291bnRlciBuYW1lPSJuYW1lMCI+MTIzPC9jb3VudGVyPgorICogICA8Y291bnRl
ciBuYW1lPSJuYW1lMSI+MjM0PC9jb3VudGVyPgorICogICA8Y291bnRlciBuYW1lPSJuYW1l
MiI+MzQ1PC9jb3VudGVyPgorICogICA6CisgKiA8L2Zvbz4KKyAqLworc3RhdGljIGludCBi
aW5kX3BhcnNlX2dlbmVyaWNfbmFtZV9hdHRyX3ZhbHVlX2xpc3QgKGNvbnN0IGNoYXIgKnhw
YXRoX2V4cHJlc3Npb24sIC8qIHt7eyAqLworICAgIGxpc3RfY2FsbGJhY2tfdCBsaXN0X2Nh
bGxiYWNrLAorICAgIHZvaWQgKnVzZXJfZGF0YSwKKyAgICB4bWxEb2MgKmRvYywgeG1sWFBh
dGhDb250ZXh0ICp4cGF0aEN0eCwKKyAgICB0aW1lX3QgY3VycmVudF90aW1lLCBpbnQgZHNf
dHlwZSkKK3sKKyAgeG1sWFBhdGhPYmplY3QgKnhwYXRoT2JqID0gTlVMTDsKKyAgaW50IG51
bV9lbnRyaWVzOworICBpbnQgaTsKKworICB4cGF0aE9iaiA9IHhtbFhQYXRoRXZhbEV4cHJl
c3Npb24oQkFEX0NBU1QgeHBhdGhfZXhwcmVzc2lvbiwgeHBhdGhDdHgpOworICBpZiAoeHBh
dGhPYmogPT0gTlVMTCkKKyAgeworICAgIEVSUk9SKCJiaW5kIHBsdWdpbjogVW5hYmxlIHRv
IGV2YWx1YXRlIFhQYXRoIGV4cHJlc3Npb24gYCVzJy4iLAorICAgICAgICB4cGF0aF9leHBy
ZXNzaW9uKTsKKyAgICByZXR1cm4gKC0xKTsKKyAgfQorCisgIG51bV9lbnRyaWVzID0gMDsK
KyAgLyogSXRlcmF0ZSBvdmVyIGFsbCBtYXRjaGluZyBub2Rlcy4gKi8KKyAgZm9yIChpID0g
MDsgeHBhdGhPYmotPm5vZGVzZXR2YWwgJiYgKGkgPCB4cGF0aE9iai0+bm9kZXNldHZhbC0+
bm9kZU5yKTsgaSsrKQorICB7CisgICAgeG1sTm9kZSAqY2hpbGQ7CisKKyAgICAvKiBJdGVy
YXRlIG92ZXIgYWxsIGNoaWxkIG5vZGVzLiAqLworICAgIGZvciAoY2hpbGQgPSB4cGF0aE9i
ai0+bm9kZXNldHZhbC0+bm9kZVRhYltpXS0+eG1sQ2hpbGRyZW5Ob2RlOworICAgICAgICBj
aGlsZCAhPSBOVUxMOworICAgICAgICBjaGlsZCA9IGNoaWxkLT5uZXh0KQorICAgIHsKKyAg
ICAgIGlmIChjaGlsZC0+dHlwZSAhPSBYTUxfRUxFTUVOVF9OT0RFKQorICAgICAgICBjb250
aW51ZTsKKworICAgICAgaWYgKHN0cm5jbXAgKCJjb3VudGVyIiwgKGNoYXIgKikgY2hpbGQt
Pm5hbWUsIHN0cmxlbiAoImNvdW50ZXIiKSkgIT0gMCkKKyAgICAgICAgY29udGludWU7CisK
KyAgICAgIGNoYXIgKmF0dHJfbmFtZTsKKyAgICAgIHZhbHVlX3QgdmFsdWU7CisgICAgICBp
bnQgc3RhdHVzOworCisgICAgICBhdHRyX25hbWUgPSAoY2hhciAqKSB4bWxHZXRQcm9wIChj
aGlsZCwgQkFEX0NBU1QgIm5hbWUiKTsKKyAgICAgIGlmIChhdHRyX25hbWUgPT0gTlVMTCkK
KyAgICAgIHsKKyAgICAgICAgREVCVUcgKCJiaW5kIHBsdWdpbjogZm91bmQgPGNvdW50ZXI+
IHdpdGhvdXQgbmFtZS4iKTsKKyAgICAgICAgY29udGludWU7CisgICAgICB9CisgICAgICBp
ZiAoZHNfdHlwZSA9PSBEU19UWVBFX0dBVUdFKQorICAgICAgICBzdGF0dXMgPSBiaW5kX3ht
bF9yZWFkX2dhdWdlIChkb2MsIGNoaWxkLCAmdmFsdWUuZ2F1Z2UpOworICAgICAgZWxzZQor
ICAgICAgICBzdGF0dXMgPSBiaW5kX3htbF9yZWFkX2Rlcml2ZSAoZG9jLCBjaGlsZCwgJnZh
bHVlLmRlcml2ZSk7CisgICAgICBpZiAoc3RhdHVzICE9IDApCisgICAgICAgIGNvbnRpbnVl
OworCisgICAgICBzdGF0dXMgPSAoKmxpc3RfY2FsbGJhY2spIChhdHRyX25hbWUsIHZhbHVl
LCBjdXJyZW50X3RpbWUsIHVzZXJfZGF0YSk7CisgICAgICBpZiAoc3RhdHVzID09IDApCisg
ICAgICAgIG51bV9lbnRyaWVzKys7CisgICAgfQorICB9CisKKyAgREVCVUcgKCJiaW5kIHBs
dWdpbjogRm91bmQgJWQgJXMgZm9yIFhQYXRoIGV4cHJlc3Npb24gYCVzJyIsCisgICAgICBu
dW1fZW50cmllcywgKG51bV9lbnRyaWVzID09IDEpID8gImVudHJ5IiA6ICJlbnRyaWVzIiwK
KyAgICAgIHhwYXRoX2V4cHJlc3Npb24pOworCisgIHhtbFhQYXRoRnJlZU9iamVjdCh4cGF0
aE9iaik7CisKKyAgcmV0dXJuICgwKTsKK30gLyogfX19IGludCBiaW5kX3BhcnNlX2dlbmVy
aWNfbmFtZV9hdHRyX3ZhbHVlX2xpc3QgKi8KKwogc3RhdGljIGludCBiaW5kX3htbF9zdGF0
c19oYW5kbGVfem9uZSAoaW50IHZlcnNpb24sIHhtbERvYyAqZG9jLCAvKiB7e3sgKi8KICAg
ICB4bWxYUGF0aENvbnRleHQgKnBhdGhfY3R4LCB4bWxOb2RlICpub2RlLCBjYl92aWV3X3Qg
KnZpZXcsCiAgICAgdGltZV90IGN1cnJlbnRfdGltZSkKQEAgLTc0NSw0NiArODIzLDY5IEBA
IHN0YXRpYyBpbnQgYmluZF94bWxfc3RhdHNfc2VhcmNoX3pvbmVzIChpbnQgdmVyc2lvbiwg
eAogc3RhdGljIGludCBiaW5kX3htbF9zdGF0c19oYW5kbGVfdmlldyAoaW50IHZlcnNpb24s
IHhtbERvYyAqZG9jLCAvKiB7e3sgKi8KICAgICB4bWxYUGF0aENvbnRleHQgKnBhdGhfY3R4
LCB4bWxOb2RlICpub2RlLCB0aW1lX3QgY3VycmVudF90aW1lKQogewotICB4bWxYUGF0aE9i
amVjdCAqcGF0aF9vYmo7CiAgIGNoYXIgKnZpZXdfbmFtZSA9IE5VTEw7CiAgIGNiX3ZpZXdf
dCAqdmlldzsKICAgaW50IGk7CiAgIHNpemVfdCBqOwogCi0gIHBhdGhfb2JqID0geG1sWFBh
dGhFdmFsRXhwcmVzc2lvbiAoQkFEX0NBU1QgIm5hbWUiLCBwYXRoX2N0eCk7Ci0gIGlmIChw
YXRoX29iaiA9PSBOVUxMKQorICBpZiAodmVyc2lvbiA9PSAzKQogICB7Ci0gICAgRVJST1Ig
KCJiaW5kIHBsdWdpbjogeG1sWFBhdGhFdmFsRXhwcmVzc2lvbiBmYWlsZWQuIik7Ci0gICAg
cmV0dXJuICgtMSk7Ci0gIH0KKyAgICB2aWV3X25hbWUgPSAoY2hhciopIHhtbEdldFByb3Ao
bm9kZSwgQkFEX0NBU1QgIm5hbWUiKTsKIAotICBmb3IgKGkgPSAwOyBwYXRoX29iai0+bm9k
ZXNldHZhbCAmJiAoaSA8IHBhdGhfb2JqLT5ub2Rlc2V0dmFsLT5ub2RlTnIpOyBpKyspCi0g
IHsKLSAgICB2aWV3X25hbWUgPSAoY2hhciAqKSB4bWxOb2RlTGlzdEdldFN0cmluZyAoZG9j
LAotICAgICAgICBwYXRoX29iai0+bm9kZXNldHZhbC0+bm9kZVRhYltpXS0+eG1sQ2hpbGRy
ZW5Ob2RlLCAxKTsKLSAgICBpZiAodmlld19uYW1lICE9IE5VTEwpCi0gICAgICBicmVhazsK
LSAgfQorICAgIGlmICh2aWV3X25hbWUgPT0gTlVMTCkKKyAgICB7CisgICAgICBFUlJPUiAo
ImJpbmQgcGx1Z2luOiBDb3VsZCBub3QgZGV0ZXJtaW5lIHZpZXcgbmFtZS4iKTsKKyAgICAg
IHJldHVybiAoLTEpOworICAgIH0KIAotICBpZiAodmlld19uYW1lID09IE5VTEwpCisgICAg
Zm9yIChqID0gMDsgaiA8IHZpZXdzX251bTsgaisrKQorICAgIHsKKyAgICAgIGlmIChzdHJj
YXNlY21wICh2aWV3X25hbWUsIHZpZXdzW2pdLm5hbWUpID09IDApCisgICAgICAgIGJyZWFr
OworICAgIH0KKworICAgIHhtbEZyZWUgKHZpZXdfbmFtZSk7CisgICAgdmlld19uYW1lID0g
TlVMTDsKKyAgfQorICBlbHNlCiAgIHsKLSAgICBFUlJPUiAoImJpbmQgcGx1Z2luOiBDb3Vs
ZCBub3QgZGV0ZXJtaW5lIHZpZXcgbmFtZS4iKTsKKyAgICB4bWxYUGF0aE9iamVjdCAqcGF0
aF9vYmo7CisgICAgcGF0aF9vYmogPSB4bWxYUGF0aEV2YWxFeHByZXNzaW9uIChCQURfQ0FT
VCAibmFtZSIsIHBhdGhfY3R4KTsKKyAgICBpZiAocGF0aF9vYmogPT0gTlVMTCkKKyAgICB7
CisgICAgICBFUlJPUiAoImJpbmQgcGx1Z2luOiB4bWxYUGF0aEV2YWxFeHByZXNzaW9uIGZh
aWxlZC4iKTsKKyAgICAgIHJldHVybiAoLTEpOworICAgIH0KKworICAgIGZvciAoaSA9IDA7
IHBhdGhfb2JqLT5ub2Rlc2V0dmFsICYmIChpIDwgcGF0aF9vYmotPm5vZGVzZXR2YWwtPm5v
ZGVOcik7IGkrKykKKyAgICB7CisgICAgICB2aWV3X25hbWUgPSAoY2hhciAqKSB4bWxOb2Rl
TGlzdEdldFN0cmluZyAoZG9jLAorICAgICAgICAgIHBhdGhfb2JqLT5ub2Rlc2V0dmFsLT5u
b2RlVGFiW2ldLT54bWxDaGlsZHJlbk5vZGUsIDEpOworICAgICAgaWYgKHZpZXdfbmFtZSAh
PSBOVUxMKQorICAgICAgICBicmVhazsKKyAgICB9CisKKyAgICBpZiAodmlld19uYW1lID09
IE5VTEwpCisgICAgeworICAgICAgRVJST1IgKCJiaW5kIHBsdWdpbjogQ291bGQgbm90IGRl
dGVybWluZSB2aWV3IG5hbWUuIik7CisgICAgICB4bWxYUGF0aEZyZWVPYmplY3QgKHBhdGhf
b2JqKTsKKyAgICAgIHJldHVybiAoLTEpOworICAgIH0KKworICAgIGZvciAoaiA9IDA7IGog
PCB2aWV3c19udW07IGorKykKKyAgICB7CisgICAgICBpZiAoc3RyY2FzZWNtcCAodmlld19u
YW1lLCB2aWV3c1tqXS5uYW1lKSA9PSAwKQorICAgICAgICBicmVhazsKKyAgICB9CisKKyAg
ICB4bWxGcmVlICh2aWV3X25hbWUpOwogICAgIHhtbFhQYXRoRnJlZU9iamVjdCAocGF0aF9v
YmopOwotICAgIHJldHVybiAoLTEpOwotICB9CiAKLSAgZm9yIChqID0gMDsgaiA8IHZpZXdz
X251bTsgaisrKQotICB7Ci0gICAgaWYgKHN0cmNhc2VjbXAgKHZpZXdfbmFtZSwgdmlld3Nb
al0ubmFtZSkgPT0gMCkKLSAgICAgIGJyZWFrOworICAgIHZpZXdfbmFtZSA9IE5VTEw7Cisg
ICAgcGF0aF9vYmogPSBOVUxMOwogICB9CiAKLSAgeG1sRnJlZSAodmlld19uYW1lKTsKLSAg
eG1sWFBhdGhGcmVlT2JqZWN0IChwYXRoX29iaik7CiAKLSAgdmlld19uYW1lID0gTlVMTDsK
LSAgcGF0aF9vYmogPSBOVUxMOwotCiAgIGlmIChqID49IHZpZXdzX251bSkKICAgICByZXR1
cm4gKDApOwogCkBAIC04MDQsMTEgKzkwNSwyMCBAQCBzdGF0aWMgaW50IGJpbmRfeG1sX3N0
YXRzX2hhbmRsZV92aWV3IChpbnQgdmVyc2lvbiwgeG0KIAogICAgIHNzbnByaW50ZiAocGx1
Z2luX2luc3RhbmNlLCBzaXplb2YgKHBsdWdpbl9pbnN0YW5jZSksICIlcy1xdHlwZXMiLAog
ICAgICAgICB2aWV3LT5uYW1lKTsKLQotICAgIGJpbmRfcGFyc2VfZ2VuZXJpY19uYW1lX3Zh
bHVlICgvKiB4cGF0aCA9ICovICJyZHR5cGUiLAorICAgIGlmICh2ZXJzaW9uID09IDMpCisg
ICAgeworICAgICAgYmluZF9wYXJzZV9nZW5lcmljX25hbWVfYXR0cl92YWx1ZV9saXN0ICgv
KiB4cGF0aCA9ICovICJjb3VudGVyc1tAdHlwZT0ncmVzcXR5cGUnXSIsCiAgICAgICAgIC8q
IGNhbGxiYWNrID0gKi8gYmluZF94bWxfbGlzdF9jYWxsYmFjaywKICAgICAgICAgLyogdXNl
cl9kYXRhID0gKi8gJmxpc3RfaW5mbywKICAgICAgICAgZG9jLCBwYXRoX2N0eCwgY3VycmVu
dF90aW1lLCBEU19UWVBFX0NPVU5URVIpOworICAgIH0KKyAgICBlbHNlCisgICAgeworICAg
ICAgYmluZF9wYXJzZV9nZW5lcmljX25hbWVfdmFsdWUgKC8qIHhwYXRoID0gKi8gInJkdHlw
ZSIsCisgICAgICAgIC8qIGNhbGxiYWNrID0gKi8gYmluZF94bWxfbGlzdF9jYWxsYmFjaywK
KyAgICAgICAgLyogdXNlcl9kYXRhID0gKi8gJmxpc3RfaW5mbywKKyAgICAgICAgZG9jLCBw
YXRoX2N0eCwgY3VycmVudF90aW1lLCBEU19UWVBFX0NPVU5URVIpOworICAgIH0KICAgfSAv
KiB9fX0gKi8KIAogICBpZiAodmlldy0+cmVzb2x2ZXJfc3RhdHMgIT0gMCkgLyoge3t7ICov
CkBAIC04MjMsMTEgKzkzMywyMCBAQCBzdGF0aWMgaW50IGJpbmRfeG1sX3N0YXRzX2hhbmRs
ZV92aWV3IChpbnQgdmVyc2lvbiwgeG0KIAogICAgIHNzbnByaW50ZiAocGx1Z2luX2luc3Rh
bmNlLCBzaXplb2YgKHBsdWdpbl9pbnN0YW5jZSksCiAgICAgICAgICIlcy1yZXNvbHZlcl9z
dGF0cyIsIHZpZXctPm5hbWUpOwotCi0gICAgYmluZF9wYXJzZV9nZW5lcmljX25hbWVfdmFs
dWUgKCJyZXNzdGF0IiwKLSAgICAgICAgLyogY2FsbGJhY2sgPSAqLyBiaW5kX3htbF90YWJs
ZV9jYWxsYmFjaywKLSAgICAgICAgLyogdXNlcl9kYXRhID0gKi8gJnRhYmxlX3B0ciwKLSAg
ICAgICAgZG9jLCBwYXRoX2N0eCwgY3VycmVudF90aW1lLCBEU19UWVBFX0NPVU5URVIpOwor
ICAgIGlmICh2ZXJzaW9uID09IDMpCisgICAgeworICAgICAgYmluZF9wYXJzZV9nZW5lcmlj
X25hbWVfYXR0cl92YWx1ZV9saXN0ICgiY291bnRlcnNbQHR5cGU9J3Jlc3N0YXRzJ10iLAor
ICAgICAgICAgIC8qIGNhbGxiYWNrID0gKi8gYmluZF94bWxfdGFibGVfY2FsbGJhY2ssCisg
ICAgICAgICAgLyogdXNlcl9kYXRhID0gKi8gJnRhYmxlX3B0ciwKKyAgICAgICAgICBkb2Ms
IHBhdGhfY3R4LCBjdXJyZW50X3RpbWUsIERTX1RZUEVfQ09VTlRFUik7CisgICAgfQorICAg
IGVsc2UKKyAgICB7CisgICAgICBiaW5kX3BhcnNlX2dlbmVyaWNfbmFtZV92YWx1ZSAoInJl
c3N0YXQiLAorICAgICAgICAgIC8qIGNhbGxiYWNrID0gKi8gYmluZF94bWxfdGFibGVfY2Fs
bGJhY2ssCisgICAgICAgICAgLyogdXNlcl9kYXRhID0gKi8gJnRhYmxlX3B0ciwKKyAgICAg
ICAgICBkb2MsIHBhdGhfY3R4LCBjdXJyZW50X3RpbWUsIERTX1RZUEVfQ09VTlRFUik7Cisg
ICAgfQogICB9IC8qIH19fSAqLwogCiAgIC8qIFJlY29yZCB0eXBlcyBpbiB0aGUgY2FjaGUg
Ki8KQEAgLTg0OSw3ICs5NjgsOCBAQCBzdGF0aWMgaW50IGJpbmRfeG1sX3N0YXRzX2hhbmRs
ZV92aWV3IChpbnQgdmVyc2lvbiwgeG0KICAgICAgICAgZG9jLCBwYXRoX2N0eCwgY3VycmVu
dF90aW1lLCBEU19UWVBFX0dBVUdFKTsKICAgfSAvKiB9fX0gKi8KIAotICBpZiAodmlldy0+
em9uZXNfbnVtID4gMCkKKyAgLy8gdjMgZG9lcyBub3QgcHJvdmlkZSBwZXItem9uZSBzdGF0
cyBhbnkgbW9yZQorICBpZiAodmVyc2lvbiA8IDMgJiYgdmlldy0+em9uZXNfbnVtID4gMCkK
ICAgICBiaW5kX3htbF9zdGF0c19zZWFyY2hfem9uZXMgKHZlcnNpb24sIGRvYywgcGF0aF9j
dHgsIG5vZGUsIHZpZXcsCiAgICAgICAgIGN1cnJlbnRfdGltZSk7CiAKQEAgLTg5NiwyOCAr
MTAxNiwxNDUgQEAgc3RhdGljIGludCBiaW5kX3htbF9zdGF0c19zZWFyY2hfdmlld3MgKGlu
dCB2ZXJzaW9uLCB4CiAgIHJldHVybiAoMCk7CiB9IC8qIH19fSBpbnQgYmluZF94bWxfc3Rh
dHNfc2VhcmNoX3ZpZXdzICovCiAKLXN0YXRpYyBpbnQgYmluZF94bWxfc3RhdHMgKGludCB2
ZXJzaW9uLCB4bWxEb2MgKmRvYywgLyoge3t7ICovCi0gICAgeG1sWFBhdGhDb250ZXh0ICp4
cGF0aEN0eCwgeG1sTm9kZSAqc3RhdHNub2RlKQorc3RhdGljIHZvaWQgYmluZF94bWxfc3Rh
dHNfdjMgKHhtbERvYyAqZG9jLCAvKiB7e3sgKi8KKyAgICB4bWxYUGF0aENvbnRleHQgKnhw
YXRoQ3R4LCB4bWxOb2RlICpzdGF0c25vZGUsIHRpbWVfdCBjdXJyZW50X3RpbWUpCiB7Ci0g
IHRpbWVfdCBjdXJyZW50X3RpbWUgPSAwOwotICBpbnQgc3RhdHVzOworICAvKiBYUGF0aDog
ICAgIHNlcnZlci9jb3VudGVyc1tAdHlwZT0nb3Bjb2RlJ10KKyAgICogVmFyaWFibGVzOiBR
VUVSWSwgSVFVRVJZLCBOT1RJRlksIFVQREFURSwgLi4uCisgICAqIExheW91dCB2MzoKKyAg
ICogICA8Y291bnRlcnMgdHlwZT0ib3Bjb2RlIj4KKyAgICogICAgIDxjb3VudGVyIG5hbWU9
IkEiPjE8L2NvdW50ZXI+CisgICAqICAgICA6CisgICAqICAgPC9jb3VudGVycz4KKyAgICov
CisgIGlmIChnbG9iYWxfb3Bjb2RlcyAhPSAwKQorICB7CisgICAgbGlzdF9pbmZvX3B0cl90
IGxpc3RfaW5mbyA9CisgICAgeworICAgICAgLyogcGx1Z2luIGluc3RhbmNlID0gKi8gImds
b2JhbC1vcGNvZGVzIiwKKyAgICAgIC8qIHR5cGUgPSAqLyAiZG5zX29wY29kZSIKKyAgICB9
OworICAgIGJpbmRfcGFyc2VfZ2VuZXJpY19uYW1lX2F0dHJfdmFsdWVfbGlzdCAoLyogeHBh
dGggPSAqLyAic2VydmVyL2NvdW50ZXJzW0B0eXBlPSdvcGNvZGUnXSIsCisgICAgICAvKiBj
YWxsYmFjayA9ICovIGJpbmRfeG1sX2xpc3RfY2FsbGJhY2ssCisgICAgICAvKiB1c2VyX2Rh
dGEgPSAqLyAmbGlzdF9pbmZvLAorICAgICAgZG9jLCB4cGF0aEN0eCwgY3VycmVudF90aW1l
LCBEU19UWVBFX0NPVU5URVIpOworICB9CiAKLSAgeHBhdGhDdHgtPm5vZGUgPSBzdGF0c25v
ZGU7CisgIC8qIFhQYXRoOiAgICAgc2VydmVyL2NvdW50ZXJzW0B0eXBlPSdxdHlwZSddCisg
ICAqIFZhcmlhYmxlczogUkVTRVJWRUQwLCBBLCBOUywgQ05BTUUsIFNPQSwgTVIsIFBUUiwg
SElORk8sIE1YLCBUWFQsIFJQLAorICAgKiAgICAgICAgICAgIFgyNSwgUFgsIEFBQUEsIExP
QywgU1JWLCBOQVBUUiwgQTYsIERTLCBSUlNJRywgTlNFQywgRE5TS0VZLAorICAgKiAgICAg
ICAgICAgIFNQRiwgVEtFWSwgSVhGUiwgQVhGUiwgQU5ZLCAuLi4sIE90aGVycworICAgKiBM
YXlvdXQgdjM6CisgICAqICAgPGNvdW50ZXJzIHR5cGU9Im9wY29kZSI+CisgICAqICAgICA8
Y291bnRlciBuYW1lPSJBIj4xPC9jb3VudGVyPgorICAgKiAgICAgOgorICAgKiAgIDwvY291
bnRlcnM+CisgICAqLworICBpZiAoZ2xvYmFsX3F0eXBlcyAhPSAwKQorICB7CisgICAgbGlz
dF9pbmZvX3B0cl90IGxpc3RfaW5mbyA9CisgICAgeworICAgICAgLyogcGx1Z2luIGluc3Rh
bmNlID0gKi8gImdsb2JhbC1xdHlwZXMiLAorICAgICAgLyogdHlwZSA9ICovICJkbnNfcXR5
cGUiCisgICAgfTsKIAotICAvKiBUT0RPOiBDaGVjayBgc2VydmVyL2Jvb3QtdGltZScgdG8g
cmVjb2duaXplIHNlcnZlciByZXN0YXJ0cy4gKi8KKyAgICBiaW5kX3BhcnNlX2dlbmVyaWNf
bmFtZV9hdHRyX3ZhbHVlX2xpc3QgKC8qIHhwYXRoID0gKi8gInNlcnZlci9jb3VudGVyc1tA
dHlwZT0ncXR5cGUnXSIsCisgICAgICAgIC8qIGNhbGxiYWNrID0gKi8gYmluZF94bWxfbGlz
dF9jYWxsYmFjaywKKyAgICAgICAgLyogdXNlcl9kYXRhID0gKi8gJmxpc3RfaW5mbywKKyAg
ICAgICAgZG9jLCB4cGF0aEN0eCwgY3VycmVudF90aW1lLCBEU19UWVBFX0NPVU5URVIpOwor
ICB9CiAKLSAgc3RhdHVzID0gYmluZF94bWxfcmVhZF90aW1lc3RhbXAgKCJzZXJ2ZXIvY3Vy
cmVudC10aW1lIiwKLSAgICAgIGRvYywgeHBhdGhDdHgsICZjdXJyZW50X3RpbWUpOwotICBp
ZiAoc3RhdHVzICE9IDApCisgIC8qIFhQYXRoOiAgICAgc2VydmVyL2NvdW50ZXJzW0B0eXBl
PSduc3N0YXQnXQorICAgKiBWYXJpYWJsZXM6IFJlcXVlc3R2NCwgUmVxdWVzdHY2LCBSZXFF
ZG5zMCwgUmVxQmFkRUROU1ZlciwgUmVxVFNJRywKKyAgICogICAgICAgICAgICBSZXFTSUcw
LCBSZXFCYWRTSUcsIFJlcVRDUCwgQXV0aFFyeVJlaiwgUmVjUXJ5UmVqLCBYZnJSZWosCisg
ICAqICAgICAgICAgICAgVXBkYXRlUmVqLCBSZXNwb25zZSwgVHJ1bmNhdGVkUmVzcCwgUmVz
cEVETlMwLCBSZXNwVFNJRywKKyAgICogICAgICAgICAgICBSZXNwU0lHMCwgUXJ5U3VjY2Vz
cywgUXJ5QXV0aEFucywgUXJ5Tm9hdXRoQW5zLCBRcnlSZWZlcnJhbCwKKyAgICogICAgICAg
ICAgICBRcnlOeHJyc2V0LCBRcnlTRVJWRkFJTCwgUXJ5Rk9STUVSUiwgUXJ5TlhET01BSU4s
IFFyeVJlY3Vyc2lvbiwKKyAgICogICAgICAgICAgICBRcnlEdXBsaWNhdGUsIFFyeURyb3Bw
ZWQsIFFyeUZhaWx1cmUsIFhmclJlcURvbmUsIFVwZGF0ZVJlcUZ3ZCwKKyAgICogICAgICAg
ICAgICBVcGRhdGVSZXNwRndkLCBVcGRhdGVGd2RGYWlsLCBVcGRhdGVEb25lLCBVcGRhdGVG
YWlsLAorICAgKiAgICAgICAgICAgIFVwZGF0ZUJhZFByZXJlcQorICAgKiBMYXlvdXQgdjM6
CisgICAqICAgPGNvdW50ZXJzIHR5cGU9Im5zc3RhdCIKKyAgICogICAgIDxjb3VudGVyIG5h
bWU9IlJlcXVlc3R2NCI+MTwvY291bnRlcj4KKyAgICogICAgIDxjb3VudGVyIG5hbWU9IlJl
cXVlc3R2NiI+MDwvY291bnRlcj4KKyAgICogICAgIDoKKyAgICogICA8L2NvdW50ZXI+Cisg
ICAqLworICBpZiAoZ2xvYmFsX3NlcnZlcl9zdGF0cykKICAgewotICAgIEVSUk9SICgiYmlu
ZCBwbHVnaW46IFJlYWRpbmcgYHNlcnZlci9jdXJyZW50LXRpbWUnIGZhaWxlZC4iKTsKLSAg
ICByZXR1cm4gKC0xKTsKKyAgICB0cmFuc2xhdGlvbl90YWJsZV9wdHJfdCB0YWJsZV9wdHIg
PQorICAgIHsKKyAgICAgIG5zc3RhdHNfdHJhbnNsYXRpb25fdGFibGUsCisgICAgICBuc3N0
YXRzX3RyYW5zbGF0aW9uX3RhYmxlX2xlbmd0aCwKKyAgICAgIC8qIHBsdWdpbl9pbnN0YW5j
ZSA9ICovICJnbG9iYWwtc2VydmVyX3N0YXRzIgorICAgIH07CisKKyAgICBiaW5kX3BhcnNl
X2dlbmVyaWNfbmFtZV9hdHRyX3ZhbHVlX2xpc3QgKCJzZXJ2ZXIvY291bnRlcnNbQHR5cGU9
J25zc3RhdCddIiwKKyAgICAgICAgLyogY2FsbGJhY2sgPSAqLyBiaW5kX3htbF90YWJsZV9j
YWxsYmFjaywKKyAgICAgICAgLyogdXNlcl9kYXRhID0gKi8gJnRhYmxlX3B0ciwKKyAgICAg
ICAgZG9jLCB4cGF0aEN0eCwgY3VycmVudF90aW1lLCBEU19UWVBFX0NPVU5URVIpOwogICB9
Ci0gIERFQlVHICgiYmluZCBwbHVnaW46IEN1cnJlbnQgc2VydmVyIHRpbWUgaXMgJWkuIiwg
KGludCkgY3VycmVudF90aW1lKTsKIAotICAvKiBYUGF0aDogICAgIHNlcnZlci9yZXF1ZXN0
cy9vcGNvZGUKKyAgLyogWFBhdGg6ICAgICBzZXJ2ZXIvem9uZXN0YXRzLCBzZXJ2ZXIvem9u
ZXN0YXQsIHNlcnZlci9jb3VudGVyc1tAdHlwZT0nem9uZXN0YXQnXQorICAgKiBWYXJpYWJs
ZXM6IE5vdGlmeU91dHY0LCBOb3RpZnlPdXR2NiwgTm90aWZ5SW52NCwgTm90aWZ5SW52Niwg
Tm90aWZ5UmVqLAorICAgKiAgICAgICAgICAgIFNPQU91dHY0LCBTT0FPdXR2NiwgQVhGUlJl
cXY0LCBBWEZSUmVxdjYsIElYRlJSZXF2NCwgSVhGUlJlcXY2LAorICAgKiAgICAgICAgICAg
IFhmclN1Y2Nlc3MsIFhmckZhaWwKKyAgICogTGF5b3V0IHYzOgorICAgKiAgIDxjb3VudGVy
cyB0eXBlPSJ6b25lc3RhdCIKKyAgICogICAgIDxjb3VudGVyIG5hbWU9Ik5vdGlmeU91dHY0
Ij4wPC9jb3VudGVyPgorICAgKiAgICAgPGNvdW50ZXIgbmFtZT0iTm90aWZ5T3V0djYiPjA8
L2NvdW50ZXI+CisgICAqICAgICA6CisgICAqICAgPC9jb3VudGVyPgorICAgKi8KKyAgaWYg
KGdsb2JhbF96b25lX21haW50X3N0YXRzKQorICB7CisgICAgdHJhbnNsYXRpb25fdGFibGVf
cHRyX3QgdGFibGVfcHRyID0KKyAgICB7CisgICAgICB6b25lc3RhdHNfdHJhbnNsYXRpb25f
dGFibGUsCisgICAgICB6b25lc3RhdHNfdHJhbnNsYXRpb25fdGFibGVfbGVuZ3RoLAorICAg
ICAgLyogcGx1Z2luX2luc3RhbmNlID0gKi8gImdsb2JhbC16b25lX21haW50X3N0YXRzIgor
ICAgIH07CisKKyAgICBiaW5kX3BhcnNlX2dlbmVyaWNfbmFtZV9hdHRyX3ZhbHVlX2xpc3Qg
KCJzZXJ2ZXIvY291bnRlcnNbQHR5cGU9J3pvbmVzdGF0J10iLAorICAgICAgICAvKiBjYWxs
YmFjayA9ICovIGJpbmRfeG1sX3RhYmxlX2NhbGxiYWNrLAorICAgICAgICAvKiB1c2VyX2Rh
dGEgPSAqLyAmdGFibGVfcHRyLAorICAgICAgICBkb2MsIHhwYXRoQ3R4LCBjdXJyZW50X3Rp
bWUsIERTX1RZUEVfQ09VTlRFUik7CisgIH0KKworICAvKiBYUGF0aDogICAgIHNlcnZlci9y
ZXNzdGF0cywgc2VydmVyL2NvdW50ZXJzW0B0eXBlPSdyZXNzdGF0J10KKyAgICogVmFyaWFi
bGVzOiBRdWVyeXY0LCBRdWVyeXY2LCBSZXNwb25zZXY0LCBSZXNwb25zZXY2LCBOWERPTUFJ
TiwgU0VSVkZBSUwsCisgICAqICAgICAgICAgICAgRk9STUVSUiwgT3RoZXJFcnJvciwgRURO
UzBGYWlsLCBNaXNtYXRjaCwgVHJ1bmNhdGVkLCBMYW1lLAorICAgKiAgICAgICAgICAgIFJl
dHJ5LCBHbHVlRmV0Y2h2NCwgR2x1ZUZldGNodjYsIEdsdWVGZXRjaHY0RmFpbCwKKyAgICog
ICAgICAgICAgICBHbHVlRmV0Y2h2NkZhaWwsIFZhbEF0dGVtcHQsIFZhbE9rLCBWYWxOZWdP
aywgVmFsRmFpbAorICAgKiBMYXlvdXQgdjM6CisgICAqICAgPGNvdW50ZXJzIHR5cGU9InJl
c3N0YXQiCisgICAqICAgICA8Y291bnRlciBuYW1lPSJRdWVyeXY0Ij4wPC9jb3VudGVyPgor
ICAgKiAgICAgPGNvdW50ZXIgbmFtZT0iUXVlcnl2NiI+MDwvY291bnRlcj4KKyAgICogICAg
IDoKKyAgICogICA8L2NvdW50ZXI+CisgICAqLworICBpZiAoZ2xvYmFsX3Jlc29sdmVyX3N0
YXRzICE9IDApCisgIHsKKyAgICB0cmFuc2xhdGlvbl90YWJsZV9wdHJfdCB0YWJsZV9wdHIg
PQorICAgIHsKKyAgICAgIHJlc3N0YXRzX3RyYW5zbGF0aW9uX3RhYmxlLAorICAgICAgcmVz
c3RhdHNfdHJhbnNsYXRpb25fdGFibGVfbGVuZ3RoLAorICAgICAgLyogcGx1Z2luX2luc3Rh
bmNlID0gKi8gImdsb2JhbC1yZXNvbHZlcl9zdGF0cyIKKyAgICB9OworCisgICAgYmluZF9w
YXJzZV9nZW5lcmljX25hbWVfYXR0cl92YWx1ZV9saXN0ICgic2VydmVyL2NvdW50ZXJzW0B0
eXBlPSdyZXNzdGF0J10iLAorICAgICAgICAvKiBjYWxsYmFjayA9ICovIGJpbmRfeG1sX3Rh
YmxlX2NhbGxiYWNrLAorICAgICAgICAvKiB1c2VyX2RhdGEgPSAqLyAmdGFibGVfcHRyLAor
ICAgICAgICBkb2MsIHhwYXRoQ3R4LCBjdXJyZW50X3RpbWUsIERTX1RZUEVfQ09VTlRFUik7
CisgIH0KK30gLyogfX19IGJpbmRfeG1sX3N0YXRzX3YzICovCisKK3N0YXRpYyB2b2lkIGJp
bmRfeG1sX3N0YXRzX3YxX3YyIChpbnQgdmVyc2lvbiwgeG1sRG9jICpkb2MsIC8qIHt7eyAq
LworICAgIHhtbFhQYXRoQ29udGV4dCAqeHBhdGhDdHgsIHhtbE5vZGUgKnN0YXRzbm9kZSwg
dGltZV90IGN1cnJlbnRfdGltZSkKK3sKKyAgLyogWFBhdGg6ICAgICBzZXJ2ZXIvcmVxdWVz
dHMvb3Bjb2RlLCBzZXJ2ZXIvY291bnRlcnNbQHR5cGU9J29wY29kZSddCiAgICAqIFZhcmlh
YmxlczogUVVFUlksIElRVUVSWSwgTk9USUZZLCBVUERBVEUsIC4uLgotICAgKiBMYXlvdXQ6
CisgICAqIExheW91dCBWMSBhbmQgVjI6CiAgICAqICAgPG9wY29kZT4KICAgICogICAgIDxu
YW1lPkE8L25hbWU+CiAgICAqICAgICA8Y291bnRlcj4xPC9jb3VudGVyPgpAQCAtOTM4LDEx
ICsxMTc1LDExIEBAIHN0YXRpYyBpbnQgYmluZF94bWxfc3RhdHMgKGludCB2ZXJzaW9uLCB4
bWxEb2MgKmRvYywgLwogICAgICAgICBkb2MsIHhwYXRoQ3R4LCBjdXJyZW50X3RpbWUsIERT
X1RZUEVfQ09VTlRFUik7CiAgIH0KIAotICAvKiBYUGF0aDogICAgIHNlcnZlci9xdWVyaWVz
LWluL3JkdHlwZQorICAvKiBYUGF0aDogICAgIHNlcnZlci9xdWVyaWVzLWluL3JkdHlwZSwg
c2VydmVyL2NvdW50ZXJzW0B0eXBlPSdxdHlwZSddCiAgICAqIFZhcmlhYmxlczogUkVTRVJW
RUQwLCBBLCBOUywgQ05BTUUsIFNPQSwgTVIsIFBUUiwgSElORk8sIE1YLCBUWFQsIFJQLAog
ICAgKiAgICAgICAgICAgIFgyNSwgUFgsIEFBQUEsIExPQywgU1JWLCBOQVBUUiwgQTYsIERT
LCBSUlNJRywgTlNFQywgRE5TS0VZLAogICAgKiAgICAgICAgICAgIFNQRiwgVEtFWSwgSVhG
UiwgQVhGUiwgQU5ZLCAuLi4sIE90aGVycwotICAgKiBMYXlvdXQ6CisgICAqIExheW91dCB2
MSBvciB2MjoKICAgICogICA8cmR0eXBlPgogICAgKiAgICAgPG5hbWU+QTwvbmFtZT4KICAg
ICogICAgIDxjb3VudGVyPjE8L2NvdW50ZXI+CkBAIC05NjIsOCArMTE5OSw4IEBAIHN0YXRp
YyBpbnQgYmluZF94bWxfc3RhdHMgKGludCB2ZXJzaW9uLCB4bWxEb2MgKmRvYywgLwogICAg
ICAgICAvKiB1c2VyX2RhdGEgPSAqLyAmbGlzdF9pbmZvLAogICAgICAgICBkb2MsIHhwYXRo
Q3R4LCBjdXJyZW50X3RpbWUsIERTX1RZUEVfQ09VTlRFUik7CiAgIH0KLSAgCi0gIC8qIFhQ
YXRoOiAgICAgc2VydmVyL25zc3RhdHMsIHNlcnZlci9uc3N0YXQKKworICAvKiBYUGF0aDog
ICAgIHNlcnZlci9uc3N0YXRzLCBzZXJ2ZXIvbnNzdGF0LCBzZXJ2ZXIvY291bnRlcnNbQHR5
cGU9J25zc3RhdCddCiAgICAqIFZhcmlhYmxlczogUmVxdWVzdHY0LCBSZXF1ZXN0djYsIFJl
cUVkbnMwLCBSZXFCYWRFRE5TVmVyLCBSZXFUU0lHLAogICAgKiAgICAgICAgICAgIFJlcVNJ
RzAsIFJlcUJhZFNJRywgUmVxVENQLCBBdXRoUXJ5UmVqLCBSZWNRcnlSZWosIFhmclJlaiwK
ICAgICogICAgICAgICAgICBVcGRhdGVSZWosIFJlc3BvbnNlLCBUcnVuY2F0ZWRSZXNwLCBS
ZXNwRUROUzAsIFJlc3BUU0lHLApAQCAtOTkyLDcgKzEyMjksNyBAQCBzdGF0aWMgaW50IGJp
bmRfeG1sX3N0YXRzIChpbnQgdmVyc2lvbiwgeG1sRG9jICpkb2MsIC8KICAgaWYgKGdsb2Jh
bF9zZXJ2ZXJfc3RhdHMpCiAgIHsKICAgICB0cmFuc2xhdGlvbl90YWJsZV9wdHJfdCB0YWJs
ZV9wdHIgPQotICAgIHsgCisgICAgewogICAgICAgbnNzdGF0c190cmFuc2xhdGlvbl90YWJs
ZSwKICAgICAgIG5zc3RhdHNfdHJhbnNsYXRpb25fdGFibGVfbGVuZ3RoLAogICAgICAgLyog
cGx1Z2luX2luc3RhbmNlID0gKi8gImdsb2JhbC1zZXJ2ZXJfc3RhdHMiCkBAIC0xMDE0LDcg
KzEyNTEsNyBAQCBzdGF0aWMgaW50IGJpbmRfeG1sX3N0YXRzIChpbnQgdmVyc2lvbiwgeG1s
RG9jICpkb2MsIC8KICAgICB9CiAgIH0KIAotICAvKiBYUGF0aDogICAgIHNlcnZlci96b25l
c3RhdHMsIHNlcnZlci96b25lc3RhdAorICAvKiBYUGF0aDogICAgIHNlcnZlci96b25lc3Rh
dHMsIHNlcnZlci96b25lc3RhdCwgc2VydmVyL2NvdW50ZXJzW0B0eXBlPSd6b25lc3RhdCdd
CiAgICAqIFZhcmlhYmxlczogTm90aWZ5T3V0djQsIE5vdGlmeU91dHY2LCBOb3RpZnlJbnY0
LCBOb3RpZnlJbnY2LCBOb3RpZnlSZWosCiAgICAqICAgICAgICAgICAgU09BT3V0djQsIFNP
QU91dHY2LCBBWEZSUmVxdjQsIEFYRlJSZXF2NiwgSVhGUlJlcXY0LCBJWEZSUmVxdjYsCiAg
ICAqICAgICAgICAgICAgWGZyU3VjY2VzcywgWGZyRmFpbApAQCAtMTAzOCw3ICsxMjc1LDcg
QEAgc3RhdGljIGludCBiaW5kX3htbF9zdGF0cyAoaW50IHZlcnNpb24sIHhtbERvYyAqZG9j
LCAvCiAgIGlmIChnbG9iYWxfem9uZV9tYWludF9zdGF0cykKICAgewogICAgIHRyYW5zbGF0
aW9uX3RhYmxlX3B0cl90IHRhYmxlX3B0ciA9Ci0gICAgeyAKKyAgICB7CiAgICAgICB6b25l
c3RhdHNfdHJhbnNsYXRpb25fdGFibGUsCiAgICAgICB6b25lc3RhdHNfdHJhbnNsYXRpb25f
dGFibGVfbGVuZ3RoLAogICAgICAgLyogcGx1Z2luX2luc3RhbmNlID0gKi8gImdsb2JhbC16
b25lX21haW50X3N0YXRzIgpAQCAtMTA2MCw3ICsxMjk3LDcgQEAgc3RhdGljIGludCBiaW5k
X3htbF9zdGF0cyAoaW50IHZlcnNpb24sIHhtbERvYyAqZG9jLCAvCiAgICAgfQogICB9CiAK
LSAgLyogWFBhdGg6ICAgICBzZXJ2ZXIvcmVzc3RhdHMKKyAgLyogWFBhdGg6ICAgICBzZXJ2
ZXIvcmVzc3RhdHMsIHNlcnZlci9jb3VudGVyc1tAdHlwZT0ncmVzc3RhdCddCiAgICAqIFZh
cmlhYmxlczogUXVlcnl2NCwgUXVlcnl2NiwgUmVzcG9uc2V2NCwgUmVzcG9uc2V2NiwgTlhE
T01BSU4sIFNFUlZGQUlMLAogICAgKiAgICAgICAgICAgIEZPUk1FUlIsIE90aGVyRXJyb3Is
IEVETlMwRmFpbCwgTWlzbWF0Y2gsIFRydW5jYXRlZCwgTGFtZSwKICAgICogICAgICAgICAg
ICBSZXRyeSwgR2x1ZUZldGNodjQsIEdsdWVGZXRjaHY2LCBHbHVlRmV0Y2h2NEZhaWwsCkBA
IC0xMDg1LDcgKzEzMjIsNyBAQCBzdGF0aWMgaW50IGJpbmRfeG1sX3N0YXRzIChpbnQgdmVy
c2lvbiwgeG1sRG9jICpkb2MsIC8KICAgaWYgKGdsb2JhbF9yZXNvbHZlcl9zdGF0cyAhPSAw
KQogICB7CiAgICAgdHJhbnNsYXRpb25fdGFibGVfcHRyX3QgdGFibGVfcHRyID0KLSAgICB7
IAorICAgIHsKICAgICAgIHJlc3N0YXRzX3RyYW5zbGF0aW9uX3RhYmxlLAogICAgICAgcmVz
c3RhdHNfdHJhbnNsYXRpb25fdGFibGVfbGVuZ3RoLAogICAgICAgLyogcGx1Z2luX2luc3Rh
bmNlID0gKi8gImdsb2JhbC1yZXNvbHZlcl9zdGF0cyIKQEAgLTExMDYsMTAgKzEzNDMsMzkg
QEAgc3RhdGljIGludCBiaW5kX3htbF9zdGF0cyAoaW50IHZlcnNpb24sIHhtbERvYyAqZG9j
LCAvCiAgICAgICAgICAgZG9jLCB4cGF0aEN0eCwgY3VycmVudF90aW1lLCBEU19UWVBFX0NP
VU5URVIpOwogICAgIH0KICAgfQorfSAvKiB9fX0gYmluZF94bWxfc3RhdHNfdjFfdjIgKi8K
IAorc3RhdGljIGludCBiaW5kX3htbF9zdGF0cyAoaW50IHZlcnNpb24sIHhtbERvYyAqZG9j
LCAvKiB7e3sgKi8KKyAgICB4bWxYUGF0aENvbnRleHQgKnhwYXRoQ3R4LCB4bWxOb2RlICpz
dGF0c25vZGUpCit7CisgIHRpbWVfdCBjdXJyZW50X3RpbWUgPSAwOworICBpbnQgc3RhdHVz
OworCisgIHhwYXRoQ3R4LT5ub2RlID0gc3RhdHNub2RlOworCisgIC8qIFRPRE86IENoZWNr
IGBzZXJ2ZXIvYm9vdC10aW1lJyB0byByZWNvZ25pemUgc2VydmVyIHJlc3RhcnRzLiAqLwor
CisgIHN0YXR1cyA9IGJpbmRfeG1sX3JlYWRfdGltZXN0YW1wICgic2VydmVyL2N1cnJlbnQt
dGltZSIsCisgICAgICBkb2MsIHhwYXRoQ3R4LCAmY3VycmVudF90aW1lKTsKKyAgaWYgKHN0
YXR1cyAhPSAwKQorICB7CisgICAgRVJST1IgKCJiaW5kIHBsdWdpbjogUmVhZGluZyBgc2Vy
dmVyL2N1cnJlbnQtdGltZScgZmFpbGVkLiIpOworICAgIHJldHVybiAoLTEpOworICB9Cisg
IERFQlVHICgiYmluZCBwbHVnaW46IEN1cnJlbnQgc2VydmVyIHRpbWUgaXMgJWkuIiwgKGlu
dCkgY3VycmVudF90aW1lKTsKKworICBpZiAodmVyc2lvbiA9PSAzKQorICB7CisgICAgYmlu
ZF94bWxfc3RhdHNfdjMoZG9jLCB4cGF0aEN0eCwgc3RhdHNub2RlLCBjdXJyZW50X3RpbWUp
OworICB9CisgIGVsc2UKKyAgeworICAgIGJpbmRfeG1sX3N0YXRzX3YxX3YyKHZlcnNpb24s
IGRvYywgeHBhdGhDdHgsIHN0YXRzbm9kZSwgY3VycmVudF90aW1lKTsKKyAgfQorCiAgIC8q
IFhQYXRoOiAgbWVtb3J5L3N1bW1hcnkKICAgICogVmFyaWFibGVzOiBUb3RhbFVzZSwgSW5V
c2UsIEJsb2NrU2l6ZSwgQ29udGV4dFNpemUsIExvc3QKLSAgICogTGF5b3V0OiB2MjoKKyAg
ICogTGF5b3V0OiB2MiBhbmQgdjM6CiAgICAqICAgPHN1bW1hcnk+CiAgICAqICAgICA8VG90
YWxVc2U+NjU4NzA5NjwvVG90YWxVc2U+CiAgICAqICAgICA8SW5Vc2U+MTM0NTQyNDwvSW5V
c2U+CkBAIC0xMTYyLDYgKzE0MjgsNjQgQEAgc3RhdGljIGludCBiaW5kX3htbCAoY29uc3Qg
Y2hhciAqZGF0YSkgLyoge3t7ICovCiAgICAgeG1sRnJlZURvYyAoZG9jKTsKICAgICByZXR1
cm4gKC0xKTsKICAgfQorCisgIC8vCisgIC8vIHZlcnNpb24gMy4qIG9mIHN0YXRpc3RpY3Mg
WE1MIChzaW5jZSBCSU5EOS45KQorICAvLworCisgIHhwYXRoT2JqID0geG1sWFBhdGhFdmFs
RXhwcmVzc2lvbiAoQkFEX0NBU1QgIi9zdGF0aXN0aWNzIiwgeHBhdGhDdHgpOworICBpZiAo
eHBhdGhPYmogPT0gTlVMTCB8fCB4cGF0aE9iai0+bm9kZXNldHZhbCA9PSBOVUxMIHx8IHhw
YXRoT2JqLT5ub2Rlc2V0dmFsLT5ub2RlTnIgPT0gMCkKKyAgeworICAgIERFQlVHICgiYmlu
ZCBwbHVnaW46IFN0YXRpc3RpY3MgYXBwZWFycyBub3QgdG8gYmUgdjMiKTsKKyAgICAvLyB3
ZSB3aWxsIGZhbGxiYWNrIHRvIHYxIG9yIHYyIGRldGVjdGlvbgorICAgIGlmICh4cGF0aE9i
aiAhPSBOVUxMKSB7IHhtbFhQYXRoRnJlZU9iamVjdCAoeHBhdGhPYmopOyB9CisgIH0KKyAg
ZWxzZQorICB7CisgICAgZm9yIChpID0gMDsgaSA8IHhwYXRoT2JqLT5ub2Rlc2V0dmFsLT5u
b2RlTnI7IGkrKykKKyAgICB7CisgICAgICB4bWxOb2RlICpub2RlOworICAgICAgY2hhciAq
YXR0cl92ZXJzaW9uOworCisgICAgICBub2RlID0geHBhdGhPYmotPm5vZGVzZXR2YWwtPm5v
ZGVUYWJbaV07CisgICAgICBhc3NlcnQgKG5vZGUgIT0gTlVMTCk7CisKKyAgICAgIGF0dHJf
dmVyc2lvbiA9IChjaGFyICopIHhtbEdldFByb3AgKG5vZGUsIEJBRF9DQVNUICJ2ZXJzaW9u
Iik7CisgICAgICBpZiAoYXR0cl92ZXJzaW9uID09IE5VTEwpCisgICAgICB7CisgICAgICAg
IE5PVElDRSAoImJpbmQgcGx1Z2luOiBGb3VuZCA8c3RhdGlzdGljcz4gdGFnIGRvZXNuJ3Qg
aGF2ZSBhICIKKyAgICAgICAgICAgICJgdmVyc2lvbicgYXR0cmlidXRlLiIpOworICAgICAg
ICBjb250aW51ZTsKKyAgICAgIH0KKyAgICAgIERFQlVHICgiYmluZCBwbHVnaW46IEZvdW5k
OiA8c3RhdGlzdGljcyB2ZXJzaW9uPVwiJXNcIj4iLCBhdHRyX3ZlcnNpb24pOworCisgICAg
ICBpZiAoc3RybmNtcCAoIjMuIiwgYXR0cl92ZXJzaW9uLCBzdHJsZW4gKCIzLiIpKSAhPSAw
KQorICAgICAgeworICAgICAgICAvKiBUT0RPOiBVc2UgdGhlIGNvbXBsYWludCBtZWNoYW5p
c20gaGVyZS4gKi8KKyAgICAgICAgTk9USUNFICgiYmluZCBwbHVnaW46IEZvdW5kIDxzdGF0
aXN0aWNzPiB0YWcgd2l0aCB2ZXJzaW9uIGAlcycuICIKKyAgICAgICAgICAgICJVbmZvcnR1
bmF0ZWx5IEkgaGF2ZSBubyBjbHVlIGhvdyB0byBwYXJzZSB0aGF0LiAiCisgICAgICAgICAg
ICAiUGxlYXNlIG9wZW4gYSBidWcgcmVwb3J0IGZvciB0aGlzLiIsIGF0dHJfdmVyc2lvbik7
CisgICAgICAgIHhtbEZyZWUgKGF0dHJfdmVyc2lvbik7CisgICAgICAgIGNvbnRpbnVlOwor
ICAgICAgfQorICAgICAgcmV0ID0gYmluZF94bWxfc3RhdHMgKDMsIGRvYywgeHBhdGhDdHgs
IG5vZGUpOworCisgICAgICB4bWxGcmVlIChhdHRyX3ZlcnNpb24pOworICAgICAgLyogT25l
IDxzdGF0aXN0aWNzPiBub2RlIG91Z2h0IHRvIGJlIGVub3VnaC4gKi8KKyAgICAgIGJyZWFr
OworICAgIH0KKworICAgIC8vIHdlIGFyZSBmaW5pc2hlZCwgZWFybHktcmV0dXJuCisgICAg
eG1sWFBhdGhGcmVlT2JqZWN0ICh4cGF0aE9iaik7CisgICAgeG1sWFBhdGhGcmVlQ29udGV4
dCAoeHBhdGhDdHgpOworICAgIHhtbEZyZWVEb2MgKGRvYyk7CisKKyAgICByZXR1cm4gKHJl
dCk7CisgIH0KKworICAvLworICAvLyB2ZXJzaW9ucyAxLiogb3IgMi4qIG9mIHN0YXRpc3Rp
Y3MgWE1MCisgIC8vCiAKICAgeHBhdGhPYmogPSB4bWxYUGF0aEV2YWxFeHByZXNzaW9uIChC
QURfQ0FTVCAiL2lzYy9iaW5kL3N0YXRpc3RpY3MiLCB4cGF0aEN0eCk7CiAgIGlmICh4cGF0
aE9iaiA9PSBOVUxMKQo=
--------------030301050805060908040300--

--QXOF2RgWocS5EkG4rmn5h8Hv5CBMdko5g
Content-Type: application/pgp-signature; name="signature.asc"
Content-Description: OpenPGP digital signature
Content-Disposition: attachment; filename="signature.asc"

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)

iQIcBAEBAgAGBQJVbFybAAoJEDHIuF9afDBUQ6YP/AqED7dmd10fxd1vWNwR9aV8
k3m/fOiqCXo11vgPVMZl59k/JZj/9XVNZa3Nm2QxscZuTsTtRv4HbcComhHfQuma
dnvsyXE+fC05RyZU7mYa+tOjzbHXJdpggNaK2C6/kG6e+EeP/XRCbWeGC96yvjJp
MKSaiP/MR4UJ9wLgCW9zRhjRbr8tQLZsGWMtLoJG0akO11mgb1psweYOHWJzgfsq
UpiGbDXEeYmMiY24FxwRbjXp2iUYJslW0VDRQ4nfD9v2BDb+xw9QfpNnc/pEkINC
zZnTbkFdM6/ERWY5FrwrhkgWM5mUTocQI0sUeS0xqF9QO/Wue7eUYIxxg62jjFez
pg6RIme4rvBtpm7MZ2J5KhPWZOM4sMir5287uHsmpW1/WNPZHRaJZThbMjbNaSur
oblws4SOmQ9p2WktZ3rRGklK8XztfVLR2H72XvdyAi9o1jLVN4HWRH/T81evpQJV
qaH/DZdsNEFA1NJUCIlKYpkUOUWNt1CCkrkJRZFQd4rmEABB1FJXHa4NCTqS/pg1
BZCrFg9utnvKWwd3LN4D+Jqs/aCiXufMspJuoCxkGysUgV6pzT6TVCVLCXAzhMLe
riGRrdS8xrwI7r+nHrMccFtyUnPFIWQ3YJFaHoIS/NDf9gyX0YYU2nfjjg2Z/2p1
jpwulQQARiWmPk8oamY5
=Zwiu
-----END PGP SIGNATURE-----

--QXOF2RgWocS5EkG4rmn5h8Hv5CBMdko5g--

